spring:
  profiles:
    include: secret, polling
    active: polling
  application:
    name: broker
  data:
    redis:
      host: ${REDIS_HOST:redis}
      port: ${REDIS_PORT:6379}
      lettuce:
        pool:
          enabled: true
          max-active: ${BROKER_REDIS_POOL_MAX_ACTIVE:256}
          max-idle: ${BROKER_REDIS_POOL_MAX_IDLE:64}
          min-idle: ${BROKER_REDIS_POOL_MIN_IDLE:16}
          max-wait: ${BROKER_REDIS_POOL_MAX_WAIT:200ms}

eureka:
  client:
    service-url:
      defaultZone: ${EUREKA_CLIENT_SERVICE_URL_DEFAULTZONE:http://eureka:8761/eureka/}
    register-with-eureka: true
    fetch-registry: true
  instance:
    instance-id: ${EUREKA_INSTANCE_INSTANCE_ID:${spring.application.name}:${server.port}}
    hostname: ${EUREKA_CLIENT_HOST_NAME:broker}

custom:
  events:
    url: ${CUSTOM_EVENTS_URL:http://app:9000}

services:
  event:
    base-url: ${EVENT_SERVICE_BASE_URL:http://app:9000}

server:
  port: ${SERVER_PORT:9002}
  tomcat:
    threads:
      max: ${BROKER_TOMCAT_THREADS_MAX:600}
      min-spare: ${BROKER_TOMCAT_THREADS_MIN_SPARE:100}
    max-connections: ${BROKER_TOMCAT_MAX_CONNECTIONS:25000}
    accept-count: ${BROKER_TOMCAT_ACCEPT_COUNT:5000}
    connection-timeout: ${BROKER_TOMCAT_CONNECTION_TIMEOUT:5s}
    keep-alive-timeout: ${BROKER_TOMCAT_KEEP_ALIVE_TIMEOUT:20s}
    max-keep-alive-requests: ${BROKER_TOMCAT_MAX_KEEP_ALIVE_REQUESTS:1000}

management:
  endpoints:
    web:
      exposure:
        include: health,info,prometheus
